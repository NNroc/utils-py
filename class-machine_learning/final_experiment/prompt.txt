
按照如下要求帮我编写代码，并进行代码注释。**要求，代码可运行，清晰简洁，完成必要要求,使用jupyter完成，降低代码耦合度** 


主题： AI for Science 
任务： 基于 NCI-ALMANAC 的抗癌药物联合用药协同效应预测

一、项目背景
在癌症治疗中，“联合用药”（Combination Therapy）是克服耐药性、提高疗效的关键策略。然而，不同的癌细胞系对药物组合的反应可能截然不同。
本次大作业基于美国国家癌症研究所（NCI）公开的 NCI-ALMANAC 数据库。你将面临一个真实的 AI 药物研发场景：利用药物的化学结构信息，在 HT-29 和 HT-116 两株不同的结直肠癌细胞系上，构建机器学习模型，预测药物组合的协同效应，并分析模型在不同细胞系上的表现差异。
二、数据集说明
本次作业提供两组数据（分别对应两个细胞系），每组数据包含两个核心文件：
1. 数据文件结构
•	dataset_smiles.csv (标签主表)：包含药物组合的配对信息和实验结果。
o	Drug_A, Drug_B: 药物名称。
o	SMILES_A, SMILES_B: 药物的化学结构字符串（可用于高阶建模）。
o	Synergy_Score: [回归目标] 协同分数（分数越高，协同越强）。
o	Class_Label: [分类目标] 离散化标签（基于阈值 ±10 划分：Synergistic, Additive, Antagonistic）。
•	dataset_features.csv (特征宽表)：已预先处理好的特征矩阵。
o	特征内容：包含了 Drug_A 和 Drug_B 的全套 RDKit 物化性质特征（如 DrugA_MolWt, DrugB_LogP 等），以及对应的标签。
o	使用方式：该表已将特征与标签对齐，可以直接用于传统机器学习建模。
2. 数据特点
•	缺失值 (Missing Values)：特征表中部分药物由于结构特殊，某些物化性质生成失败（显示为 NaN）。
•	多任务支持：同时支持回归（预测具体分数）和分类（预测协同/拮抗类别）任务。
三、核心任务要求
必须完成以下基础模块：
1. 探索性数据分析 (EDA) & 数据预处理
•	数据概览：统计数据的维度、字段类型、缺失值比例。
•	可视化分析：
o	绘制特征的分布图（直方图/箱线图）。
o	绘制特征与目标变量的相关性分析（如相关系数热力图、散点图），并给出你的解读。
2. 数据预处理
•	缺失值处理：分析特征缺失的比例，检查是否存在缺失值。若存在缺失值，是直接删除这些样本，还是使用均值/KNN进行填补？请陈述你的策略和理由。
•	数据编码：如何处理 Categorical 特征？
•	特征缩放（Scaling）：标准化（Standardization）还是归一化（Normalization）？请解释选择理由。
•	特征选择：使用特征选择方法（如相关性筛选、卡方检验等）剔除冗余特征。
•	数据划分：两个方法，分别实现。使用 交叉验证 (Cross-Validation)（如 5-Fold）来评估模型性能。实现 “按药物留一法” (Leave-Drugs-Out) 划分。选定 $N$ 种药物，将所有涉及这 $N$ 种药物的组合放入测试集。目标：评估模型在训练集中从未见过的新药物组合上的泛化能力。
3. 建模任务
你需要分别在 HT-29 和 HT-116 两个数据集上完成以下建模任务：
•	任务 A：协同分数预测（回归）
o	目标：预测连续变量 Synergy_Score。
o	模型：对比 线性模型 (如Lasso / Ridge) 和 非线性模型 (如Random Forest / XGBoost)。
o	评估：RMSE (均方根误差) 、Pearson Correlation (皮尔逊相关系数)、R2等。
•	任务 B：协同效应分类（分类）
o	目标：预测离散变量 Class_Label。
o	模型：对比 基础模型 (如SVM、Decision Tree) 和 集成模型 (如Bagging、Boosting)。
o	评估：Confusion Matrix、Accuracy、F1-Score (Macro/Weighted)、AUC、AUPR等。
•	多范式建模： 利用 $SMILES$ 字符串，探索分子结构信息。探索方向：图神经网络 (GNN)： 将分子视为图结构，尝试提取图特征或直接进行图学习。NLP / Large Models： 将 $SMILES$ 视为文本序列，使用预训练的化学大模型（如 $\text{ChemBERTa}$）提取高维特征，并将其作为输入特征之一。
4. 结果对比与分析
•	跨细胞系对比
o	同一个模型结构在 HT-29 和 HT-116 上的表现一致吗？如果差异较大，尝试分析原因。
•	特征重要性
o	输出最佳模型的前 10 个重要特征。分析决定药物协同的关键特征在两个细胞系中是否相同？（例如：是否在 HT-29 中亲脂性 LogP 更重要？）
5. 超参数调优 
•	选择表现最好的那个模型，使用 GridSearchCV 或 RandomizedSearchCV 进行超参数搜索。
•	报告最佳参数组合，并展示调优前后的性能提升。
